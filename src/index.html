<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>有余数的除法教学工具</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2980 0%, #26d0ce 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            color: #333;
        }
        
        .container {
            width: 100%;
            max-width: 900px;
            background-color: rgba(255, 255, 255, 0.97);
            border-radius: 20px;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(90deg, #2c3e50 0%, #4a6491 100%);
            color: white;
            text-align: center;
            padding: 20px;
            border-bottom: 3px solid #ffb74d;
        }
        
        header h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
        }
        
        .tabs {
            display: flex;
            background-color: #f0f4f8;
            border-bottom: 1px solid #ddd;
        }
        
        .tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            background-color: #e3f2fd;
        }
        
        .tab.active {
            background-color: white;
            color: #1a73e8;
            border-bottom: 3px solid #1a73e8;
        }
        
        .tab-content {
            display: none;
            padding: 25px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* 教学演示模式样式 */
        .control-row {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 25px;
            margin-bottom: 25px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 12px;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.08);
        }
        
        .control-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .control-row label {
            font-weight: 600;
            color: #1a237e;
            font-size: 1.1rem;
        }
        
        select {
            padding: 10px 15px;
            border: 2px solid #bbdefb;
            border-radius: 8px;
            font-size: 1rem;
            background-color: white;
            transition: border-color 0.3s;
            min-width: 80px;
        }
        
        select:focus {
            border-color: #1a73e8;
            outline: none;
        }
        
        .equation {
            font-size: 1.5rem;
            font-weight: bold;
            color: #0d47a1;
            padding: 10px 15px;
            background-color: #e3f2fd;
            border-radius: 8px;
            min-width: 150px;
        }
        
        .demo-container {
            display: flex;
            gap: 20px;
            margin-bottom: 25px;
        }
        
        .pencil-area {
            flex: 1;
            min-height: 220px;
            border: 2px dashed #90caf9;
            border-radius: 12px;
            padding: 20px;
            background-color: #f5fbff;
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: center;
            gap: 8px;
            position: relative;
        }
        
        .division-area {
            width: 120px; /* 修改宽度为120px */
            min-height: 220px;
            border: 2px dashed #90caf9;
            border-radius: 12px;
            padding: 20px;
            background-color: #f5fbff;
            display: flex;
            align-items: center;
            justify-content: center;
            display: none; /* 初始化时隐藏 */
        }
        
        .pencil {
            width: 12px;
            height: 120px;
            background: linear-gradient(to bottom, #ffca28 0%, #ff9800 100%);
            border-radius: 2px 2px 8px 8px;
            position: relative;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }
        
        .pencil::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 20px;
            background: linear-gradient(to bottom, #8d6e63 0%, #5d4037 100%);
            border-radius: 2px 2px 0 0;
        }
        
        .pencil::after {
            content: '';
            position: absolute;
            top: 20px;
            left: 3px;
            width: 6px;
            height: 10px;
            background: #ffb74d;
            border-radius: 0 0 3px 3px;
        }
        
        .group {
            padding: 8px;
            border-radius: 10px;
            margin: 0 5px 15px 5px;
            display: inline-flex;
            flex-wrap: wrap;
            gap: 8px;
            transition: all 0.5s ease;
            align-items: center;
            justify-content: center;
        }
        
        .blue-group {
            background-color: rgba(33, 150, 243, 0.2);
            border: 2px solid #2196f3;
        }
        
        .orange-group {
            background-color: rgba(255, 152, 0, 0.2);
            border: 2px dashed #ff9800;
        }
        
        .button-row {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 12px 25px;
            font-size: 1rem;
            font-weight: 600;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: linear-gradient(45deg, #1a73e8, #0d47a1);
            color: white;
        }
        
        .btn-secondary {
            background: linear-gradient(45deg, #26a69a, #00796b);
            color: white;
        }
        
        .btn-info {
            background: linear-gradient(45deg, #9c27b0, #7b1fa2);
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
        
        .btn:active {
            transform: translateY(1px);
        }
        
        .step-description {
            background-color: #e8f5e9;
            border-left: 5px solid #4caf50;
            padding: 15px 20px;
            border-radius: 8px;
            font-size: 1.1rem;
            color: #2e7d32;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.08);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        /* 竖式计算表格样式 */
        .division-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 1.8rem;
            font-weight: bold;
            font-family: 'Courier New', monospace;
            text-align: right;
        }
        
        .division-table td {
            height: 30px;
            padding: 0;
            position: relative;
        }
        
        .division-table .col1 {
            width: 20px;
        }
        
        .division-table .col2 {
            width: 10px;
        }
        
        .division-table .col3 {
            width: 15px; /* 缩减一半宽度 */
        }
        
        .divisor {
            color: #1a73e8;
        }
        
        .dividend {
            color: #333;
        }
        
        .quotient {
            color: #4CAF50;
        }
        
        .product {
            color: #9C27B0;
        }
        
        .remainder {
            color: #FF9800;
        }
        
        /* 修改表格边框样式 */
        .division-table .line {
            border-bottom: none; /* 去掉第一行第三列的下边框 */
        }
        .division-table tr:nth-child(2) td:nth-child(2),
        .division-table tr:nth-child(2) td:nth-child(3) {
            border-top: 3px solid #333; /* 第二行第二列和第三列的上边框变实线且加粗 */
        }
        
        .preparing {
            color: #aaa;
            font-style: italic;
            font-size: 1.2rem;
            text-align: center;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* 习题测试模式样式 */
        .exercise-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .exercise-card {
            background-color: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            border: 1px solid #e0e0e0;
            transition: transform 0.3s;
            padding-left: 100px; /* 左侧留出100px空间 */
            height: 100px; /* 行高100px */
            display: flex;
            align-items: center; /* 垂直居中 */
        }
        
        .exercise-row {
            display: flex;
            align-items: center;
            justify-content: flex-start; /* 靠左排列 */
            flex-wrap: wrap;
            gap: 15px;
            width: 100%;
        }
        
        .exercise-equation {
            font-size: 1.8rem;
            font-weight: bold;
            color: #1a237e;
            white-space: nowrap;
        }
        
        .answer-inputs {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .input-group {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        input {
            padding: 12px 15px;
            width: 80px;
            text-align: center;
            font-size: 1.2rem;
            border: 2px solid #bbdefb;
            border-radius: 8px;
            transition: border-color 0.3s;
        }
        
        input:focus {
            border-color: #1a73e8;
            outline: none;
            box-shadow: 0 0 0 2px rgba(26, 115, 232, 0.2);
        }
        
        .result-container {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }
        
        .result {
            font-size: 1.4rem;
            font-weight: bold;
            min-height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .correct {
            color: #4caf50;
        }
        
        .incorrect {
            color: #f44336;
        }
        
        .correct-answer {
            font-size: 1.1rem;
            color: #7e57c2;
            font-weight: 500;
        }
        
        .button-group {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 10px;
        }
        
        .footer-note {
            text-align: center;
            margin-top: 25px;
            padding-top: 15px;
            border-top: 1px solid #e0e0e0;
            color: #757575;
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .control-row {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .control-group {
                width: 100%;
                justify-content: space-between;
            }
            
            .demo-container {
                flex-direction: column;
            }
            
            .division-area {
                width: 100%;
                min-height: 150px;
            }
            
            .button-row {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                max-width: 300px;
            }
            
            .step-description {
                font-size: 1rem;
                padding: 12px 15px;
            }
            
            .button-group {
                flex-direction: column;
                align-items: center;
            }
            
            .exercise-row {
                flex-direction: column;
                align-items: center;
            }
            
            .exercise-card {
                padding-left: 20px; /* 在小屏幕上减少左侧间距 */
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>有余数的除法教学工具</h1>
            <p>互动式学习除法中的余数</p>
        </header>
        
        <div class="tabs">
            <div class="tab active" data-tab="demo">教学演示模式</div>
            <div class="tab" data-tab="exercise">习题测试模式</div>
        </div>
        
        <!-- 教学演示模式 -->
        <div id="demo-content" class="tab-content active">
            <div class="control-row">
                <div class="control-group">
                    <label>被除数</label>
                    <select id="dividend-select">
                        <!-- 被除数选项将通过JS生成 -->
                    </select>
                </div>
                
                <div class="control-group">
                    <label>除数</label>
                    <select id="divisor-select">
                        <!-- 除数选项将通过JS生成 -->
                    </select>
                </div>
                
                <div class="control-group">
                    <label>算式：</label>
                    <div class="equation" id="equation">10 ÷ 3 =</div>
                </div>
            </div>
            
            <div class="demo-container">
                <div class="pencil-area" id="pencil-container">
                    <!-- 铅笔将通过JS动态生成 -->
                </div>
                <div class="division-area" id="division-container">
                    <table class="division-table" id="division-table">
                        <!-- 竖式计算表格将通过JS动态生成 -->
                    </table>
                </div>
            </div>
            
            <div class="button-row">
                <button id="start-btn" class="btn btn-primary"><i class="fas fa-play-circle"></i> 开始计算</button>
                <button id="reset-btn" class="btn btn-secondary"><i class="fas fa-redo-alt"></i> 重置</button>
                <button id="show-long-division" class="btn btn-info"><i class="fas fa-calculator"></i> 显示竖式</button>
            </div>
            
            <div class="step-description" id="step-description">
                请选择被除数和除数，然后点击"开始计算"按钮开始演示
            </div>
        </div>
        
        <!-- 习题测试模式 -->
        <div id="exercise-content" class="tab-content">
            <div class="exercise-container" id="exercise-container">
                <!-- 习题将通过JS动态生成 -->
            </div>
            
            <div class="button-group">
                <button id="generate-btn" class="btn btn-primary"><i class="fas fa-plus-circle"></i> 出题</button>
                <button id="check-answer" class="btn btn-primary"><i class="fas fa-check-circle"></i> 检查答案</button>
            </div>
            
            <div class="footer-note">
                提示：软件由作者构思后，指导AI优化代码并打包完成
            </div>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 全局变量
            let currentStep = 0;
            let currentDividend = 10;
            let currentDivisor = 3;
            let longDivisionVisible = false;
            
            // DOM 元素
            const demoContent = document.getElementById('demo-content');
            const exerciseContent = document.getElementById('exercise-content');
            const tabs = document.querySelectorAll('.tab');
            const dividendSelect = document.getElementById('dividend-select');
            const divisorSelect = document.getElementById('divisor-select');
            const equation = document.getElementById('equation');
            const pencilContainer = document.getElementById('pencil-container');
            const startBtn = document.getElementById('start-btn');
            const resetBtn = document.getElementById('reset-btn');
            const showLongDivisionBtn = document.getElementById('show-long-division');
            const stepDescription = document.getElementById('step-description');
            const divisionTable = document.getElementById('division-table');
            const divisionContainer = document.getElementById('division-container');
            const generateBtn = document.getElementById('generate-btn');
            const exerciseContainer = document.getElementById('exercise-container');
            const checkAnswerBtn = document.getElementById('check-answer');
            
            // 生成下拉选项
            function populateSelectOptions() {
                // 生成被除数选项 (1-30)
                for (let i = 1; i <= 30; i++) {
                    const option = document.createElement('option');
                    option.value = i;
                    option.textContent = i;
                    if (i === 10) option.selected = true;
                    dividendSelect.appendChild(option);
                }
                
                // 生成除数选项 (1-9)
                for (let i = 1; i <= 9; i++) {
                    const option = document.createElement('option');
                    option.value = i;
                    option.textContent = i;
                    if (i === 3) option.selected = true;
                    divisorSelect.appendChild(option);
                }
            }
            
            // 切换标签页
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    tabs.forEach(t => t.classList.remove('active'));
                    tab.classList.add('active');
                    
                    demoContent.classList.remove('active');
                    exerciseContent.classList.remove('active');
                    
                    if (tab.dataset.tab === 'demo') {
                        demoContent.classList.add('active');
                    } else {
                        exerciseContent.classList.add('active');
                        // 切换到习题模式时自动生成题目
                        generateExercises();
                    }
                });
            });
            
            // 更新算式
            function updateEquation() {
                equation.textContent = `${currentDividend} ÷ ${currentDivisor} =`;
            }
            
            // 更新完整算式
            function updateFullEquation() {
                const quotient = Math.floor(currentDividend / currentDivisor);
                const remainder = currentDividend % currentDivisor;
                equation.textContent = `${currentDividend} ÷ ${currentDivisor} = ${quotient} 余 ${remainder}`;
            }
            
            // 生成铅笔
            function generatePencils() {
                pencilContainer.innerHTML = '';
                
                // 创建铅笔元素
                for (let i = 0; i < currentDividend; i++) {
                    const pencil = document.createElement('div');
                    pencil.classList.add('pencil');
                    pencilContainer.appendChild(pencil);
                }
            }
            
            // 创建竖式表格
            function createDivisionTable() {
                // 清空表格
                divisionTable.innerHTML = '';
                
                // 创建4行3列的表格
                for (let i = 0; i < 4; i++) {
                    const row = document.createElement('tr');
                    
                    for (let j = 0; j < 3; j++) {
                        const cell = document.createElement('td');
                        
                        // 设置列宽
                        if (j === 0) {
                            cell.className = 'col1';
                        } else if (j === 1) {
                            cell.className = 'col2';
                        } else {
                            cell.className = 'col3';
                        }
                        

                        row.appendChild(cell);
                    }
                    
                    divisionTable.appendChild(row);
                }
            }
            
            // 更新竖式表格
            function updateDivisionTable() {
                const quotient = Math.floor(currentDividend / currentDivisor);
                const remainder = currentDividend % currentDivisor;
                const product = quotient * currentDivisor;
                
                // 获取表格行
                const rows = divisionTable.rows;
                
                // 重置所有单元格内容
                for (let i = 0; i < 4; i++) {
                    for (let j = 0; j < 3; j++) {
                        rows[i].cells[j].innerHTML = '';
                    }
                }
                
                // 隐藏所有行
                for (let i = 0; i < 4; i++) {
                    rows[i].style.display = 'none';
                }
                
                // 开始计算前显示准备状态
                if (currentStep === 0) {
                    // 不显示准备计算中
                    return;
                }
                
                // 第一步：展示除数和被除数
                if (currentStep >= 1) {
                    rows[1].style.display = 'table-row';
                    
                    // 第二行：除数
                    const divisorCell = rows[1].cells[0];
                    divisorCell.innerHTML = `<span class="divisor">${currentDivisor}</span>`;
                    
                    // 第二行：右括号
                    rows[1].cells[1].innerHTML = '<span>)</span>';
                    
                    // 第二行：被除数
                    const dividendCell = rows[1].cells[2];
                    dividendCell.innerHTML = `<span class="dividend">${currentDividend}</span>`;
                }
                
                // 第二步：展示商和乘积
                if (currentStep >= 2) {
                    rows[0].style.display = 'table-row';
                    rows[2].style.display = 'table-row';
                    
                    // 第一行：商
                    const quotientCell = rows[0].cells[2];
                    quotientCell.innerHTML = `<span class="quotient">${quotient}</span>`;
                    
                    // 第三行：乘积
                    const productCell = rows[2].cells[2];
                    productCell.innerHTML = `<span class="product">${product}</span>`;
                    
                    // 第三行第三列添加下边框
                    rows[2].cells[2].classList.add('line');
                    rows[2].cells[2].style.borderBottom = '3px solid #333'; // 加粗下边框
                }
                
                // 第三步：展示余数
                if (currentStep >= 3) {
                    rows[3].style.display = 'table-row';
                    
                    // 第四行：余数
                    const remainderCell = rows[3].cells[2];
                    remainderCell.innerHTML = `<span class="remainder">${remainder}</span>`;
                }
                if (currentStep >= 4) {
                    rows[3].style.display = 'table-row';
                    
                    // 第四行：余数
                    const remainderCell = rows[3].cells[2];
                    remainderCell.innerHTML = `<span class="remainder">${remainder}</span>`;
                }
                // 第四步时保持第3行第3列的下边框线显示
                rows[2].cells[2].classList.add('line');
            }
            
            // 初始化演示
            function initDemo() {
                currentStep = 0;
                startBtn.innerHTML = '<i class="fas fa-play-circle"></i> 开始计算';
                stepDescription.innerHTML = `请选择被除数和除数，然后点击"开始计算"按钮开始演示`;
                generatePencils();
                updateEquation(); // 只显示 10 ÷ 3 =
                
                // 修改：初始化时保持竖式区域显示，但根据longDivisionVisible控制表格内容
                divisionContainer.style.display = longDivisionVisible ? 'flex' : 'none';
                
                // 更新竖式表格
                if (longDivisionVisible) {
                    updateDivisionTable();
                }
            }
            
            // 执行步骤
            function executeStep() {
                const quotient = Math.floor(currentDividend / currentDivisor);
                const remainder = currentDividend % currentDivisor;
                
                switch (currentStep) {
                    case 0: // 初始状态
                        currentStep = 1;
                        startBtn.innerHTML = '<i class="fas fa-arrow-right"></i> 第二步';
                        stepDescription.innerHTML = 
                            `这是${currentDividend} ÷ ${currentDivisor}计算，把${currentDividend}支铅笔平均分成${currentDivisor}份，看看能分成几份，还剩几支。`;
                        break;
                    
                    case 1: // 第一步
                        currentStep = 2;
                        startBtn.innerHTML = '<i class="fas fa-arrow-right"></i> 第三步';
                        
                        // 分组铅笔（每divisor支一组）
                        pencilContainer.innerHTML = '';
                        let pencilCount = 0;
                        
                        for (let i = 0; i < quotient; i++) {
                            const group = document.createElement('div');
                            group.classList.add('group', 'blue-group');
                            
                            for (let j = 0; j < currentDivisor; j++) {
                                const pencil = document.createElement('div');
                                pencil.classList.add('pencil');
                                group.appendChild(pencil);
                                pencilCount++;
                            }
                            
                            pencilContainer.appendChild(group);
                        }
                        
                        // 添加剩余铅笔（还未分组）
                        for (let i = pencilCount; i < currentDividend; i++) {
                            const pencil = document.createElement('div');
                            pencil.classList.add('pencil');
                            pencilContainer.appendChild(pencil);
                        }
                        
                        stepDescription.innerHTML = 
                            `铅笔每${currentDivisor}支分一份，可以分成${quotient}份。`;
                        break;
                    
                    case 2: // 第二步
                        currentStep = 3;
                        startBtn.innerHTML = '<i class="fas fa-arrow-right"></i> 重新开始';
                        
                        // 分组剩余铅笔
                        if (remainder > 0) {
                            pencilContainer.innerHTML = '';
                            
                            // 添加完整组
                            for (let i = 0; i < quotient; i++) {
                                const group = document.createElement('div');
                                group.classList.add('group', 'blue-group');
                                
                                for (let j = 0; j < currentDivisor; j++) {
                                    const pencil = document.createElement('div');
                                    pencil.classList.add('pencil');
                                    group.appendChild(pencil);
                                }
                                
                                pencilContainer.appendChild(group);
                            }
                            
                            // 添加余数组
                            if (remainder > 0) {
                                const remainderGroup = document.createElement('div');
                                remainderGroup.classList.add('group', 'orange-group');
                                
                                for (let i = 0; i < remainder; i++) {
                                    const pencil = document.createElement('div');
                                    pencil.classList.add('pencil');
                                    remainderGroup.appendChild(pencil);
                                }
                                
                                pencilContainer.appendChild(remainderGroup);
                            }
                        }
                        updateFullEquation();
                        stepDescription.innerHTML = 
                            `计算 ${currentDividend} - ${currentDivisor} × ${quotient} = ${remainder}，表示分${quotient}份后还剩${remainder}支铅笔，这就是余数。`;
                        break;
                    
                    case 3: // 第三步
                        currentStep = 0;
                        startBtn.innerHTML = '<i class="fas fa-play-circle"></i> 重新开始';
                        stepDescription.innerHTML = 
                            `计算完成，${currentDividend} ÷ ${currentDivisor} = ${quotient} 余 ${remainder}`;
                        updateFullEquation();
                        // 显示所有行
                        const rows = divisionTable.rows;
                        for (let i = 0; i < 4; i++) {
                            rows[i].style.display = 'table-row';
                        }
                        initDemo();
                        break;
                }
                
                // 更新竖式表格
                if (longDivisionVisible) {
                    updateDivisionTable();
                }
            }
            
            // 生成习题
            function generateExercises() {
                exerciseContainer.innerHTML = '';
                
                for (let i = 0; i < 3; i++) {
                    let dividend, divisor, quotient, remainder;
                    
                    // 确保有余数且除数不为0
                    do {
                        divisor = Math.floor(Math.random() * 8) + 2; // 2-9
                        dividend = Math.floor(Math.random() * 28) + divisor + 1; // 大于除数
                        quotient = Math.floor(dividend / divisor);
                        remainder = dividend % divisor;
                    } while (remainder === 0);
                    
                    const exerciseCard = document.createElement('div');
                    exerciseCard.classList.add('exercise-card');
                    exerciseCard.innerHTML = `
                        <div class="exercise-row">
                            <div class="exercise-equation">${dividend} ÷ ${divisor} =</div>
                            <div class="answer-inputs">
                                <input type="number" min="0" class="quotient-input" data-dividend="${dividend}" data-divisor="${divisor}">
                                <span>余</span>
                                <input type="number" min="0" class="remainder-input">
                            </div>
                            <div class="result-container" id="result-container-${i}"></div>
                        </div>
                    `;
                    
                    exerciseContainer.appendChild(exerciseCard);
                }
            }
            
            // 检查答案
            function checkAnswers() {
                const quotientInputs = document.querySelectorAll('.quotient-input');
                const remainderInputs = document.querySelectorAll('.remainder-input');
                
                quotientInputs.forEach((input, index) => {
                    const dividend = parseInt(input.dataset.dividend);
                    const divisor = parseInt(input.dataset.divisor);
                    const quotient = Math.floor(dividend / divisor);
                    const remainder = dividend % divisor;
                    
                    const userQuotient = parseInt(input.value) || 0;
                    const userRemainder = parseInt(remainderInputs[index].value) || 0;
                    
                    const resultContainer = document.getElementById(`result-container-${index}`);
                    resultContainer.innerHTML = '';
                    
                    if (userQuotient === quotient && userRemainder === remainder) {
                        const resultDiv = document.createElement('div');
                        resultDiv.classList.add('result', 'correct');
                        resultDiv.innerHTML = '<i class="fas fa-check-circle"></i> 正确';
                        resultContainer.appendChild(resultDiv);
                    } else {
                        const resultDiv = document.createElement('div');
                        resultDiv.classList.add('result', 'incorrect');
                        resultDiv.innerHTML = '<i class="fas fa-times-circle"></i> 错误';
                        resultContainer.appendChild(resultDiv);
                        
                        const correctAnswer = document.createElement('div');
                        correctAnswer.classList.add('correct-answer');
                        correctAnswer.textContent = `正确答案: ${quotient} 余 ${remainder}`;
                        resultContainer.appendChild(correctAnswer);
                    }
                });
            }
            
            // 事件监听器
            dividendSelect.addEventListener('change', function() {
                currentDividend = parseInt(this.value);
                // 确保除数小于被除数
                if (currentDividend <= currentDivisor) {
                    currentDivisor = Math.max(1, currentDividend - 1);
                    divisorSelect.value = currentDivisor;
                }
                initDemo();
            });
            
            divisorSelect.addEventListener('change', function() {
                currentDivisor = parseInt(this.value);
                // 确保除数小于被除数
                if (currentDividend <= currentDivisor) {
                    currentDividend = currentDivisor + 1;
                    dividendSelect.value = currentDividend;
                }
                initDemo();
            });
            
            startBtn.addEventListener('click', executeStep);
            
            resetBtn.addEventListener('click', initDemo);
            
            showLongDivisionBtn.addEventListener('click', function() {
                longDivisionVisible = !longDivisionVisible;
                divisionContainer.style.display = longDivisionVisible ? 'flex' : 'none';
                this.innerHTML = longDivisionVisible ? 
                    '<i class="fas fa-eye-slash"></i> 隐藏竖式' : 
                    '<i class="fas fa-calculator"></i> 显示竖式';
                
                // 第一次显示时创建竖式表格
                if (longDivisionVisible && divisionTable.rows.length === 0) {
                    createDivisionTable();
                    updateDivisionTable();

                }
                initDemo();
            });
            
            generateBtn.addEventListener('click', generateExercises);
            
            checkAnswerBtn.addEventListener('click', checkAnswers);
            
            // 初始化
            populateSelectOptions();
            initDemo();
            createDivisionTable();
        });
    </script>
</body>
</html>